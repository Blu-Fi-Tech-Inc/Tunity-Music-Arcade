{"ast":null,"code":"var _jsxFileName = \"D:\\\\PRIDE\\\\frontend\\\\src\\\\components\\\\Waveform.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from \"react\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport { formatDuration } from \"../utils/formatDuration\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Waveform = _ref => {\n  _s();\n  let {\n    className,\n    audioUrl\n  } = _ref;\n  const waveContainerRef = useRef(null);\n  const wavesurfer = useRef(null);\n  const canvasRef = useRef(null);\n  const durationRef = useRef(null);\n  const timeRef = useRef(null);\n  const currentProgress = useSelector(state => state.progressReducer);\n  const currentSong = useSelector(state => state.currentSongReducer);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (wavesurfer.current) {\n      wavesurfer.current.on(\"ready\", () => {\n        if (durationRef.current) {\n          durationRef.current.textContent = formatDuration(wavesurfer.current.getDuration().toFixed(0));\n        }\n      });\n    }\n  }, []);\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height * 1.35);\n    gradient.addColorStop(0, \"#656666\"); // Top color\n    gradient.addColorStop(canvas.height * 0.7 / canvas.height, \"#656666\"); // Top color\n    gradient.addColorStop((canvas.height * 0.7 + 1) / canvas.height, \"#ffffff\"); // White line\n    gradient.addColorStop((canvas.height * 0.7 + 2) / canvas.height, \"#ffffff\"); // White line\n    gradient.addColorStop((canvas.height * 0.7 + 3) / canvas.height, \"#B1B1B1\"); // Bottom color\n    gradient.addColorStop(1, \"#B1B1B1\"); // Bottom color\n\n    const progressGradient = ctx.createLinearGradient(0, 0, 0, canvas.height * 1.35);\n    progressGradient.addColorStop(0, \"#EE772F\"); // Top color\n    progressGradient.addColorStop(canvas.height * 0.7 / canvas.height, \"#EB4926\"); // Top color\n    progressGradient.addColorStop((canvas.height * 0.7 + 1) / canvas.height, \"#ffffff\"); // White line\n    progressGradient.addColorStop((canvas.height * 0.7 + 2) / canvas.height, \"#ffffff\"); // White line\n    progressGradient.addColorStop((canvas.height * 0.7 + 3) / canvas.height, \"#F6B094\"); // Bottom color\n    progressGradient.addColorStop(1, \"#F6B094\"); // Bottom color\n\n    wavesurfer.current = WaveSurfer.create({\n      container: waveContainerRef.current,\n      responsive: true,\n      waveColor: gradient,\n      progressColor: progressGradient,\n      height: 80,\n      interact: true,\n      cursorColor: \"#000\",\n      barWidth: 3,\n      barRadius: 3,\n      barGap: 0.75,\n      normalize: true\n    });\n\n    // wavesurfer.current.on(\"ready\", () => {\n    //   // Start the AudioContext after a user gesture\n    //   wavesurfer.current.backend.ac.resume();\n    // });\n\n    wavesurfer.current.load(audioUrl);\n    wavesurfer.current.on(\"click\", () => {\n      // Handle logic for the 'ontimeupdate' equivalent here\n      // For example, update the current time or progress bar\n\n      const currentTime = wavesurfer.current.getCurrentTime();\n      dispatch({\n        type: \"MODIFYPROGRESS\",\n        progress: currentTime\n      });\n    });\n    return () => {\n      // Clean up the WaveSurfer instance on component unmount\n      wavesurfer.current.destroy();\n    };\n  }, [audioUrl]);\n\n  // set progress\n  useEffect(() => {\n    if (!audioUrl || !currentSong || audioUrl !== currentSong.audioUrl) {\n      return;\n    }\n    if (currentProgress) {\n      wavesurfer.current.setTime(currentProgress * wavesurfer.current.duration / 100);\n    } else {\n      wavesurfer.current.setTime(0);\n    }\n    if (timeRef.current) {\n      timeRef.current.textContent = formatDuration(wavesurfer.current.getCurrentTime().toFixed(0));\n    }\n  }, [currentProgress]);\n  const timeStyle = \"absolute z-10 top-1/4 text-xs bg-[rgba(0, 0, 0, 0.75)] p-0.5 text-[#ddd] bg-black text-[8px]\";\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `overflow-hidden h-[50px] relative w-full ${className} `,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: waveContainerRef,\n      className: \"cursor-pointer relative transform h-[100px]\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: timeRef,\n      className: `${timeStyle} left-0 text-[#f50]`,\n      children: \"0:00\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: durationRef,\n      className: `${timeStyle} right-0`,\n      onClick: () => wavesurfer.current.play(),\n      children: \"0:00\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 5\n  }, this);\n};\n_s(Waveform, \"aY/Tzz3XKmAmAHydRPTSWgxV/L8=\", false, function () {\n  return [useSelector, useSelector, useDispatch];\n});\n_c = Waveform;\nexport default Waveform;\nvar _c;\n$RefreshReg$(_c, \"Waveform\");","map":{"version":3,"names":["React","useEffect","useRef","WaveSurfer","formatDuration","useDispatch","useSelector","jsxDEV","_jsxDEV","Waveform","_ref","_s","className","audioUrl","waveContainerRef","wavesurfer","canvasRef","durationRef","timeRef","currentProgress","state","progressReducer","currentSong","currentSongReducer","dispatch","current","on","textContent","getDuration","toFixed","canvas","ctx","getContext","gradient","createLinearGradient","height","addColorStop","progressGradient","create","container","responsive","waveColor","progressColor","interact","cursorColor","barWidth","barRadius","barGap","normalize","load","currentTime","getCurrentTime","type","progress","destroy","setTime","duration","timeStyle","children","ref","fileName","_jsxFileName","lineNumber","columnNumber","onClick","play","_c","$RefreshReg$"],"sources":["D:/PRIDE/frontend/src/components/Waveform.jsx"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport { formatDuration } from \"../utils/formatDuration\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nconst Waveform = ({ className, audioUrl }) => {\n  const waveContainerRef = useRef(null);\n  const wavesurfer = useRef(null);\n  const canvasRef = useRef(null);\n  const durationRef = useRef(null);\n  const timeRef = useRef(null);\n  const currentProgress = useSelector((state) => state.progressReducer);\n  const currentSong = useSelector((state) => state.currentSongReducer);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (wavesurfer.current) {\n      wavesurfer.current.on(\"ready\", () => {\n        if (durationRef.current) {\n          durationRef.current.textContent = formatDuration(\n            wavesurfer.current.getDuration().toFixed(0)\n          );\n        }\n      });\n    }\n  }, []);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n\n    const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height * 1.35);\n    gradient.addColorStop(0, \"#656666\"); // Top color\n    gradient.addColorStop((canvas.height * 0.7) / canvas.height, \"#656666\"); // Top color\n    gradient.addColorStop((canvas.height * 0.7 + 1) / canvas.height, \"#ffffff\"); // White line\n    gradient.addColorStop((canvas.height * 0.7 + 2) / canvas.height, \"#ffffff\"); // White line\n    gradient.addColorStop((canvas.height * 0.7 + 3) / canvas.height, \"#B1B1B1\"); // Bottom color\n    gradient.addColorStop(1, \"#B1B1B1\"); // Bottom color\n\n    const progressGradient = ctx.createLinearGradient(\n      0,\n      0,\n      0,\n      canvas.height * 1.35\n    );\n    progressGradient.addColorStop(0, \"#EE772F\"); // Top color\n    progressGradient.addColorStop(\n      (canvas.height * 0.7) / canvas.height,\n      \"#EB4926\"\n    ); // Top color\n    progressGradient.addColorStop(\n      (canvas.height * 0.7 + 1) / canvas.height,\n      \"#ffffff\"\n    ); // White line\n    progressGradient.addColorStop(\n      (canvas.height * 0.7 + 2) / canvas.height,\n      \"#ffffff\"\n    ); // White line\n    progressGradient.addColorStop(\n      (canvas.height * 0.7 + 3) / canvas.height,\n      \"#F6B094\"\n    ); // Bottom color\n    progressGradient.addColorStop(1, \"#F6B094\"); // Bottom color\n\n    wavesurfer.current = WaveSurfer.create({\n      container: waveContainerRef.current,\n      responsive: true,\n      waveColor: gradient,\n      progressColor: progressGradient,\n      height: 80,\n      interact: true,\n      cursorColor: \"#000\",\n      barWidth: 3,\n      barRadius: 3,\n      barGap: 0.75,\n      normalize: true,\n    });\n\n    // wavesurfer.current.on(\"ready\", () => {\n    //   // Start the AudioContext after a user gesture\n    //   wavesurfer.current.backend.ac.resume();\n    // });\n\n    wavesurfer.current.load(audioUrl);\n\n    wavesurfer.current.on(\"click\", () => {\n      // Handle logic for the 'ontimeupdate' equivalent here\n      // For example, update the current time or progress bar\n\n      const currentTime = wavesurfer.current.getCurrentTime();\n      dispatch({\n        type: \"MODIFYPROGRESS\",\n        progress: currentTime,\n      });\n    });\n    return () => {\n      // Clean up the WaveSurfer instance on component unmount\n      wavesurfer.current.destroy();\n    };\n  }, [audioUrl]);\n\n  // set progress\n  useEffect(() => {\n    if (!audioUrl || !currentSong || audioUrl !== currentSong.audioUrl) {\n      return;\n    }\n    if (currentProgress) {\n      wavesurfer.current.setTime(\n        (currentProgress * wavesurfer.current.duration) / 100\n      );\n    } else {\n      wavesurfer.current.setTime(0);\n    }\n    if (timeRef.current) {\n      timeRef.current.textContent = formatDuration(\n        wavesurfer.current.getCurrentTime().toFixed(0)\n      );\n    }\n  }, [currentProgress]);\n  const timeStyle =\n    \"absolute z-10 top-1/4 text-xs bg-[rgba(0, 0, 0, 0.75)] p-0.5 text-[#ddd] bg-black text-[8px]\";\n\n  return (\n    <div className={`overflow-hidden h-[50px] relative w-full ${className} `}>\n      <div\n        ref={waveContainerRef}\n        className=\"cursor-pointer relative transform h-[100px]\"\n      />\n      <canvas ref={canvasRef} />\n      <div ref={timeRef} className={`${timeStyle} left-0 text-[#f50]`}>\n        0:00\n      </div>\n      <div\n        ref={durationRef}\n        className={`${timeStyle} right-0`}\n        onClick={() => wavesurfer.current.play()}\n      >\n        0:00\n      </div>\n    </div>\n  );\n};\n\nexport default Waveform;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}